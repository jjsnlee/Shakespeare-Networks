function QueryString(){this.parameters=[]}QueryString.prototype.parameters=function(){for(var a=0;a<arguments.length;a++)this.addValueParameter(arguments[a])};QueryString.prototype.addValueParameter=function(a,d,b,c){if(void 0===d||null===d)d=a;if(void 0===c||null===c)c=void 0===b||null===b?"str":b;if(void 0===b||null===b)b="str";a={name:a,identifier:d,isArray:!1,decoder:this.valueDecoder(b),encoder:this.valueEncoder(c)};this.parameters.push(a);return this};
QueryString.prototype.addArrayParameter=function(a,d,b,c){if(void 0===d||null===d)d=a;if(void 0===c||null===c)c=void 0===b||null===b?"str":b;if(void 0===b||null===b)b="str";a={name:a,identifier:d,isArray:!0,decoder:this.arrayDecoder(b),encoder:this.arrayEncoder(c)};this.parameters.push(a);return this};
QueryString.prototype.valueDecoder=function(a){return"function"==typeof a?a:"string"==typeof a?"int"==a?function(a){return parseInt(a,10)}:"float"==a?function(a){return parseFloat(a)}:function(a){return a}:null};QueryString.prototype.valueEncoder=function(a){return"function"==typeof a?a:"string"==typeof a?function(a){return String(a)}:null};QueryString.prototype.arrayDecoder=function(a){return"function"==typeof a?a:function(d){var b=this.valueDecoder(a),c=[];d.forEach(function(a){c.push(b(a))});return c}.bind(this)};
QueryString.prototype.arrayEncoder=function(a){return"function"==typeof a?a:function(d){var b=this.valueEncoder(a),c=[];d.forEach(function(a){c.push(b(a))});return c}.bind(this)};QueryString.prototype.read=function(a){if(void 0===a||null===a)a={};for(var d in this.parameters){var b=this.parameters[d];if(b.isArray){var c=this.getValues(b.identifier);0<c.length&&(a[b.name]=b.decoder(c))}else c=this.getValue(b.identifier),null!=c&&(a[b.name]=b.decoder(c))}return a};
QueryString.prototype.write=function(a,d,b,c){if(void 0===d||"boolean"!=typeof d)d=!1;void 0===b&&(b=null);void 0===c&&(c=null);var g=[],k;for(k in this.parameters){var e=this.parameters[k];if(e.name in a)if(e.isArray){var f=e.encoder(a[e.name]),h;for(h in f)0<f[h].length&&g.push(e.identifier+"="+escape(f[h]))}else f=e.encoder(a[e.name]),0<f.length&&g.push(e.identifier+"="+escape(f))}a=window.location.protocol+"//"+window.location.host+window.location.pathname+(0<g.length?"?"+g.join("&"):"");d?history.replaceState(b,
c,a):history.pushState(b,c,a)};QueryString.prototype.getValue=function(a){a=this.getKeyRegex(a).exec(window.location.href);return null===a?null:unescape(a[1])};QueryString.prototype.getValues=function(a){var d=this.getKeyRegex(a),b=window.location.href.match(d);if(null===b)return[];for(var c=0;c<b.length;c++)d=this.getKeyRegex(a),d=d.exec(b[c]),b[c]=unescape(d[1]);return b};QueryString.prototype.getKeyRegex=function(a){return RegExp("[\\?&]"+a+"=([^&]*)","g")};
